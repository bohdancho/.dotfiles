#!/usr/bin/env bash

# Set Session Name
SESSION="vscubing-next"
SESSIONEXISTS=$(tmux list-sessions | grep $SESSION)

if [ "$SESSIONEXISTS" = "" ]; then
    # Start New Session with our name
    tmux new-session -d -s $SESSION -c "$HOME/personal/vscubing/vscubing-next"

    # Window 2: vscubing-frontend
    tmux rename-window -t $SESSION:1 'vim'
    tmux send-keys -t $SESSION:1 'cd ~/personal/vscubing/vscubing-next' C-m 'vim' C-m

    # Window 2: vscubing-frontend - Run dev server
    tmux new-window -t $SESSION:2 -n 'server'
    tmux send-keys -t $SESSION:2 'cd ~/personal/vscubing/vscubing-next' C-m 'bun run dev' C-m

    # Window 3: vscubing-frontend
    tmux new-window -t $SESSION:3 -n 'db'
    tmux send-keys -t $SESSION:3 'cd ~/personal/vscubing/vscubing-next' C-m './start-database' C-m 'bun db:studio' C-m
fi

tmux switch-client -t $SESSION:1
